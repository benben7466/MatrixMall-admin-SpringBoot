<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bzq.matrixmall.mapper.product.ProdInfoMapper">
    <!-- 根据商品ID获取详情 -->
    <select id="getProdInfoFormData" resultType="com.bzq.matrixmall.model.entity.product.ProdInfo">
        SELECT
            id,
            product_name,
            product_name_sub,
            brand_id,
            specifications,
            unit,
            expiration_date,
            producing_area,
            seo_keyword,
            seo_description
        FROM
            prod_info
        WHERE
            id = #{prodId} AND is_deleted = 0
    </select>

    <!-- 商品信息分页列表 -->
    <select id="listPageProdInfo" resultType="com.bzq.matrixmall.model.vo.product.ProdInfoVO">
        SELECT
        p.id,
        p.product_name,
        p.product_name_sub,
        b.brand_name,
        p.specifications,
        p.unit,
        p.expiration_date,
        p.producing_area,
        p.seo_keyword,
        p.seo_description,
        p.update_time
        FROM
        prod_info p
        LEFT JOIN prod_brand b ON b.id = p.brand_id
        <where>
            p.is_deleted = 0
            <if test='queryParams.keywords!=null and queryParams.keywords.trim() neq ""'>
                AND (
                p.product_name LIKE CONCAT('%',#{queryParams.keywords},'%')
                OR p.product_name_sub LIKE CONCAT('%',#{queryParams.keywords},'%')
                )
            </if>
        </where>
        ORDER BY
        p.create_time DESC
    </select>
</mapper>